/* Polices : iA Writer Duo pour le contenu, Inter pour l'interface */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 220 10% 98%; /* Gris très clair, presque blanc */
    --foreground: 220 15% 20%; /* Noir doux, presque anthracite */
    --subtle: 220 10% 60%; /* Gris moyen pour les métadonnées */
    --accent: 220 90% 55%; /* Un bleu encre profond et académique */
    --destructive: 0 84% 60%; /* Rouge pour erreurs et danger */
    --success: 142 76% 36%; /* Vert pour succès */
    --muted: 220 10% 95%; /* Arrière-plans neutres très clairs */
  }

  /* Optionnel: pour un futur thème sombre */
  /* .dark { ... } */

  body {
    @apply bg-background text-foreground font-sans;
    /* Ajout d'un dégradé radial très subtil pour donner vie au fond */
    background-image:
      radial-gradient(circle at top left, hsl(220 10% 95%), transparent),
      radial-gradient(circle at bottom right, hsl(220 90% 98%), transparent);
    background-size: 100vw 100vh;
    background-attachment: fixed;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: 'iA Writer Duo', 'IBM Plex Mono', monospace;
    font-weight: 600;
  }

  a {
    @apply hover:underline;
  }
}

@layer components {
  /* Animations légères */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  @keyframes slideDown {
    from {
      transform: translateY(-8px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  .fade-in {
    animation: fadeIn 200ms ease-out both;
  }
  .slide-down {
    animation: slideDown 220ms ease-out both;
  }

  /* Masquer scrollbar horizontale du carrousel (mobile) */
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  /* UI Verre - Utilitaire glass */
  .glass {
    @apply bg-background/35 backdrop-blur-md border border-white/10;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.05),
      0 2px 4px -1px rgba(0, 0, 0, 0.03);
  }

  .glass-light {
    @apply bg-background/25 backdrop-blur-sm border border-white/10;
  }

  /* Constellation intégrée v2 - Budget opacité global */
  .interactive-graph-background {
    opacity: 0.8;
    transition: opacity 0.6s ease;
  }

  .interactive-graph-background .node-main {
    opacity: 0.6;
    transition: opacity 0.3s ease;
  }

  .interactive-graph-background .node-label {
    opacity: 0.35;
  }

  .interactive-graph-background .edge {
    opacity: 0.25;
  }

  /* Overlay clones */
  .interactive-graph-overlay {
    z-index: 1;
  }

  /* Supprimer les soulignements sur les liens SVG */
  .interactive-graph-overlay a,
  .interactive-graph-background a {
    text-decoration: none !important;
  }

  .interactive-graph-overlay a:hover,
  .interactive-graph-background a:hover {
    text-decoration: none !important;
  }

  /* Constellation intégrée - Animations et états */
  @keyframes dash {
    from {
      stroke-dashoffset: 10;
    }
    to {
      stroke-dashoffset: 0;
    }
  }

  @keyframes twinkle {
    0%,
    100% {
      opacity: 0.02;
    }
    50% {
      opacity: 0.08;
    }
  }

  /* Zone de frappe invisible sur fond */
  .interactive-graph-background .node-hit {
    opacity: 0;
    cursor: pointer;
    pointer-events: auto;
  }

  .interactive-graph-background .node-hit:focus {
    opacity: 0.05;
    outline: 2px solid hsl(var(--accent));
    outline-offset: 2px;
  }

  /* États voisinage sur fond */
  .interactive-graph-background [data-id].neighbor .node-main {
    opacity: 0.45;
    transform: scale(1.05);
  }

  /* Arêtes actives sur fond */
  .interactive-graph-background .edge.neighbor-active {
    opacity: 0.25;
    stroke-width: 2;
    stroke-dasharray: 5 5;
    animation: dash 1.8s ease-in-out infinite;
  }

  /* Twinkles subtils pour signaler la présence */
  @media (prefers-reduced-motion: no-preference) {
    .interactive-graph .node-main:nth-child(3n) {
      animation: twinkle 8s ease-in-out infinite;
      animation-delay: 0s;
    }

    .interactive-graph .node-main:nth-child(5n) {
      animation: twinkle 12s ease-in-out infinite;
      animation-delay: 4s;
    }
  }

  /* Désactivation pour préférence mouvement réduit */
  @media (prefers-reduced-motion: reduce) {
    .interactive-graph * {
      animation: none !important;
      transition: none !important;
    }
  }

  .btn {
    @apply inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium transition-all duration-200;
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background;
  }
  .btn-primary {
    @apply btn bg-foreground text-background shadow-sm hover:bg-foreground/90;
  }
  .btn-secondary {
    @apply btn bg-background border border-subtle/50 text-foreground shadow-sm hover:bg-muted;
  }
  .btn-danger {
    @apply btn bg-destructive text-white shadow-sm hover:bg-destructive/90;
  }

  .card {
    @apply bg-background/80 border border-transparent rounded-lg shadow-sm transition-all duration-300 hover:border-subtle/50 hover:shadow-md backdrop-blur-sm p-6;
  }

  .input-field {
    @apply w-full px-3 py-2 border border-subtle focus:outline-none focus:border-foreground transition-colors duration-200;
  }

  .search-input {
    @apply glass text-foreground rounded-full outline-none
           transition-all duration-300;
  }
  .search-input:focus {
    @apply ring-2 ring-accent/50;
    border-color: hsl(var(--accent) / 0.4);
  }

  /* Styles pour les backlinks [[mot]] */
  .backlink {
    @apply text-foreground hover:opacity-70 font-normal underline transition-opacity duration-200;
    text-decoration: underline;
  }

  .backlink[data-missing='true'] {
    @apply text-subtle hover:opacity-70;
  }

  /* Prose styles pour les billets */
  .prose {
    @apply text-foreground leading-relaxed;
  }

  .prose h1,
  .prose h2,
  .prose h3 {
    @apply font-serif text-foreground mb-4 font-light;
  }

  .prose h1 {
    @apply text-3xl;
  }

  .prose h2 {
    @apply text-2xl;
  }

  .prose h3 {
    @apply text-xl;
  }

  .prose p {
    @apply mb-4 text-base;
  }

  .prose blockquote {
    @apply border-l-2 border-subtle pl-4 italic text-subtle my-6;
  }

  .prose ul,
  .prose ol {
    @apply mb-4 pl-6;
  }

  .prose li {
    @apply mb-2;
  }
} /* motif de grille très léger pour le hero */
.grid-pattern {
  background-image:
    radial-gradient(currentColor 1px, transparent 1px),
    radial-gradient(currentColor 1px, transparent 1px);
  background-size:
    24px 24px,
    24px 24px;
  background-position:
    0 0,
    12px 12px;
  color: rgba(0, 0, 0, 0.05);
}
:root .dark .grid-pattern {
  color: rgba(255, 255, 255, 0.06);
}
/* QuoteTicker animation */
.ticker {
  animation: ticker-scroll 40s linear infinite;
}
@keyframes ticker-scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-50%);
  }
}
@media (prefers-reduced-motion: reduce) {
  .ticker {
    animation: none;
  }
}
/* --- L'athanor accents (S1 minimal) --- */
.accent-card {
  position: relative;
}
.accent-card::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.08), rgba(0, 0, 0, 0));
}
.dark .accent-card::before {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0));
}

/* Lecture un peu plus souple */
p,
li {
  text-wrap: pretty;
}

/* Légère amélioration des hover sur liens */
a:hover {
  text-underline-offset: 4px;
  text-decoration-thickness: from-font;
}

/* Utilitaire pour zone de lecture étroite (à activer au besoin) */
.reading {
  max-width: 72ch;
}

/* Animation pour l'effet Ripple */
@keyframes ripple-effect {
  0% {
    transform: scale(0);
    opacity: 1;
  }
  100% {
    transform: scale(4);
    opacity: 0;
  }
}

/* Enhanced search result snippet styling */
.card-search-result strong {
  @apply font-semibold text-foreground bg-accent/10 px-1 py-0.5 rounded;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
